# gcc/g++

## 流程参数

```sh
# 预处理，文件包含、宏替换等
-E
g++ test.cpp -E -o test.i

# 编译，生成汇编语言文件
-S
g++ test.cpp -S # 输出 test.s 文件
g++ test.i -S

# 汇编，生成目标文件
-C
g++ test.cpp -C -o test.o
g++ test.s -C -o test.o

# 链接，生成可执行程序, 
```



# make



# objdump

```sh
# 查看程序汇编代码
# 把生成的机器码反汇编为汇编语言
objdump -D a.out
```



# ldd

```sh
# 查看程序依赖/链接的库
ldd a.out
```



# 动态库

动态库只在生成的可执行文件中生成 插桩 函数 `plt`（汇编），当可执行文件被加载时会读取指定目录的 `.dll/.so` 文件，加载到内存中空闲的位置，并且替换相应的插桩指向的地址为加载后的地址，这个过程被称为重定向。这样以后函数被调用就会跳转到动态加载的地址中去。

## 查找顺序

1. windows是先查找同目录，再查找环境变量 %PATH% 
2. Linux: ELF格式可执行文件的 RPATH，其次是 /usr/lib 等。（每个可执行文件可以指定自己的 RPATH）































