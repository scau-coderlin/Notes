# 前言

> Cargo 是内置的依赖管理器和构建工具，它能轻松增加、编译和管理依赖，并使依赖在 Rust 生态系统中保持一致。



# 命令参数

```shell
cargo --version

## 创建项目

# cargo new project_name
cargo new hello_cargo

# 不包含git, 如果创建的目录下以及保护git仓库, 那么cargo不会创建.git文件
cargo new no_git --vcs none

# 查看帮助
cargo new --help

# 创建库项目
cargo new --lib pro_name

## 构建项目

# cd pro_dir 

cargo build
cargo run # 运行, 未编译会先编译

cargo test # 库项目

cargo build --release # 发布版本, 优化

## code check
cargo check # 检查是否能通过编译
```



# cargo.toml

```toml
# cargo.toml # 位于项目根目录下

[package]
name = "hello_cargo" 	# 项目名
version = "0.1.0"		# 项目版本
edition = "2021"		# 使用的rust版本
authors = ["linj<linj@keyou.cn>]	# 作者

# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html

# 项目所需要的依赖项
[dependencies]

[build-dependencies] # 构建时需要的依赖项, 主要用于适配环境

[dev-dependencies] # 只在开发时需要的依赖项, 主要用于测试, 加载测试环境
```



# crago.lock

> 无需手动修改, 由cargo进行管理，该文件负责追踪项目依赖的精确版本



# 更新create

```sh
cargo update

cargo update -p regex   # 只更新 “regex”
```



# 第三方库管理

> https://crates.io/



## 通过命令

```sh
# 安装 cargo-edit
# 无需安装, 官方自带
cargo install cargo-edit

# 使用cargo add 添加库
cargo add openssl
cargo add openssl@version # cargo add openssl@0.10.64

# 添加到dev/build模式
cargo add --dev openssl@version
cargo add --build openssl@version

# 删除库
cargo rm openssl
```



## 直接修改cargo.toml

```sh
# 引入git仓库的依赖
[dependencies]
regex = { git = "https://github.com/rust-lang/regex", branch = "next" }

# 引入本地依赖
# 一般来说，本地依赖包都是同一个项目内的内部包，例如假设我们有一个 hello_world 项目( package )，现在在其根目录下新建一个包
cargo new hello_utils

# 新建的 hello_utils 文件夹跟 src、Cargo.toml 同级，现在修改 Cargo.toml 让 hello_world 项目引入新建的包:
[dependencies]
hello_utils = { path = "hello_utils" }
# 以下路径也可以
# hello_utils = { path = "./hello_utils" }
# hello_utils = { path = "../hello_world/hello_utils" }
```



# 设置国内源

> 推荐 rsproxy.cn

文件：~/.cargo/config

```sh
[source.crates-io]
replace-with = 'rsproxy-sparse'
[source.rsproxy]
registry = "https://rsproxy.cn/crates.io-index"
[source.rsproxy-sparse]
registry = "sparse+https://rsproxy.cn/index/"
[registries.rsproxy]
index = "https://rsproxy.cn/crates.io-index"
[net]
git-fetch-with-cli = true
```



# 查看文档

```sh
# 注意：你不可能凭空就知道应该 use 哪个 trait 以及该从 crate 中调用哪个方法，因此每个 crate 有使用说明文档。Cargo 有一个很棒的功能是：运行 cargo doc --open 命令来构建所有本地依赖提供的文档，并在浏览器中打开。例如，假设你对 rand crate 中的其他功能感兴趣，你可以运行 cargo doc --open 并点击左侧导航栏中的 rand。
cargo doc --open
```

